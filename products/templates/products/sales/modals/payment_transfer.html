<!-- Modal ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô - ‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô -->
<dialog id="payment-transfer-modal" class="modal">
  <div class="modal-box max-w-2xl">
    
    <!-- Header -->
    <div class="flex justify-between items-center mb-6">
      <h3 class="text-2xl font-bold">üí∞ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô (‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô)</h3>
      <button class="btn btn-sm btn-circle btn-ghost" onclick="closeTransferModal()">‚úï</button>
    </div>
    
    <!-- Content -->
    <div class="space-y-6">
      
      <!-- ‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞ -->
      <div class="text-center bg-primary/10 p-4 rounded-lg">
        <p class="text-gray-600 text-sm">‡∏¢‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ä‡∏≥‡∏£‡∏∞</p>
        <p class="text-5xl font-bold text-primary" id="modal-transfer-total">0.00 ‡∏ø</p>
      </div>
      
      <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏±‡∏ç‡∏ä‡∏µ -->
      <div class="bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-lg">
        <div class="flex items-center gap-4 mb-4">
          <div class="text-5xl">üè¶</div>
          <div>
            <h4 class="font-bold text-xl">‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏Å‡∏™‡∏¥‡∏Å‡∏£‡πÑ‡∏ó‡∏¢</h4>
            <p class="text-sm text-gray-600">Kasikorn Bank</p>
          </div>
        </div>
        
        <div class="divider"></div>
        
        <div class="space-y-3">
          <div class="flex justify-between items-center bg-white p-3 rounded">
            <span class="text-gray-600">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ç‡∏ä‡∏µ:</span>
            <span class="font-mono font-bold text-xl">053-3-48115-9</span>
          </div>
          
          <div class="flex justify-between items-center bg-white p-3 rounded">
            <span class="text-gray-600">‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ:</span>
            <span class="font-bold">‡∏®‡∏∏‡∏†‡∏°‡∏á‡∏Ñ‡∏• ‡πÑ‡∏ä‡∏¢‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì</span>
          </div>
          
          <div class="flex justify-between items-center bg-white p-3 rounded">
            <span class="text-gray-600">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô:</span>
            <span class="font-bold text-xl text-primary" id="modal-transfer-amount">0.00 ‡∏ö‡∏≤‡∏ó</span>
          </div>
        </div>
      </div>
      
      <!-- ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ -->
      <div class="alert alert-warning">
        <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
        </svg>
        <div>
          <h3 class="font-bold">‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç!</h3>
          <div class="text-sm">
            ‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏¥‡∏•‡πÉ‡∏ô‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô:<br>
            <span class="font-mono font-bold text-base" id="modal-transfer-doc-no">-</span>
          </div>
        </div>
      </div>
      
      <!-- Checkbox ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô -->
      <div class="form-control">
        <label class="label cursor-pointer justify-start gap-4">
          <input type="checkbox" id="modal-transfer-confirm" class="checkbox checkbox-lg checkbox-success" />
          <span class="label-text text-lg">‚úÖ ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß (‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡πÅ‡∏•‡πâ‡∏ß)</span>
        </label>
      </div>
      
    </div>
    
    <!-- Footer -->
    <div class="modal-action">
      <button class="btn btn-lg btn-outline" onclick="closeTransferModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
      <button class="btn btn-success btn-lg" onclick="confirmTransferPayment()">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
        </svg>
        ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
      </button>
    </div>
    
  </div>
  
  <!-- Background Overlay -->
  <form method="dialog" class="modal-backdrop">
    <button>‡∏õ‡∏¥‡∏î</button>
  </form>
</dialog>

<script>
// ===================================
// Modal ‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô - Functions
// ===================================

function openTransferModal() {
  // ‡∏î‡∏∂‡∏á‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
  const grandTotal = parseFloat(document.getElementById('grand-total').textContent.replace(' ‡∏ø', '')) || 0;
  const docNo = document.getElementById('doc-no').textContent;
  
  // ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô Modal
  document.getElementById('modal-transfer-total').textContent = grandTotal.toFixed(2) + ' ‡∏ø';
  document.getElementById('modal-transfer-amount').textContent = grandTotal.toFixed(2) + ' ‡∏ö‡∏≤‡∏ó';
  document.getElementById('modal-transfer-doc-no').textContent = docNo;
  
  // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï Checkbox
  document.getElementById('modal-transfer-confirm').checked = false;
  
  // ‡πÄ‡∏õ‡∏¥‡∏î Modal
  document.getElementById('payment-transfer-modal').showModal();
}

function closeTransferModal() {
  document.getElementById('payment-transfer-modal').close();
}

function confirmTransferPayment() {
  const confirmed = document.getElementById('modal-transfer-confirm').checked;
  
  if (!confirmed) {
    alert('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß');
    return;
  }
  
  const totalText = document.getElementById('modal-transfer-total').textContent.replace(' ‡∏ø', '');
  const grandTotal = parseFloat(totalText) || 0;
  
  // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
  window.paymentData = {
    method: 'transfer',
    received: grandTotal,
    change: 0
  };
  
  // ‡∏õ‡∏¥‡∏î Modal
  closeTransferModal();
  
  // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ö‡∏¥‡∏•
  saveSaleWithPayment();
}
</script>